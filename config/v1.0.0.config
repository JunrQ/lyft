{
    'config' : {
        'model' : {
            'name' : 'EncoderDecoder',
            'params' : {
              'decoder_params' : {
                'input_channels' : 3 + 2 * (10 + 1),
                'depth' : 34,
                'encoder_feature_size' : 1024,
              },
              'encoder_params' : {
                'decoder_dim' : 512, # hidden state
                'encoder_dim' : 1024,
                'prediction_length' : 50,
                'positions' : 10,
                'input_dim' : 512
              }
            },
        },
    
        # 'max_epoch' : 100,
        'max_steps' : 100000,
        'optimizer' : {
            'type' : 'SGD',
            'lr' : 0.1,
            'momentum' : 0.9,
            'weight_decay' : 4e-5,
        },
    
        'scheduler' : {
          'type' : 'MultiStepLR',
          'milestones' : [2000, 4000, 8000, 16000, 20000, 40000, 60000, 80000],
          'gamma' : 0.33
        },

        'criterion' : {
          'type' : 'MSELoss',
        }
    },

    'data_config' : { 'format_version': 4,
        'path' : '/home/MSAI/zhou0365/git/lyft/data',
        'model_params': {
            'history_num_frames': 10,
            'history_step_size': 1,
            'history_delta_time': 0.1,
            'future_num_frames': 50,
            'future_step_size': 1,
            'future_delta_time': 0.1
        },
        
        'raster_params': {
            'raster_size': [256, 256],
            'pixel_size': [0.5, 0.5],
            'ego_center': [0.25, 0.5],
            'map_type': 'py_semantic',
            'satellite_map_key': 'aerial_map/aerial_map.png',
            'semantic_map_key': 'semantic_map/semantic_map.pb',
            'dataset_meta_key': 'meta.json',
            'filter_agents_threshold': 0.5
        },
        
        'train_data_loader': {
            'key': 'scenes/train.zarr',
            'batch_size': 64,
            'shuffle': True,
            'num_workers': 16
        },

        'sample_data_loader' : {
            'key': 'scenes/sample.zarr',
            'batch_size': 64,
            'shuffle': False,
            'num_workers': 8
        },
    
        'validate_data_loader' : {
            'key': 'scenes/validate.zarr',
            'batch_size': 32,
            'shuffle': False,
            'num_workers': 8
        },
    
        'test_data_loader': {
            'key': 'scenes/test.zarr',
            'batch_size': 32,
            'shuffle': False,
            'num_workers': 4
        },
    }
}
